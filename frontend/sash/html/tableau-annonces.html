<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <!-- META DATA -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="description"
      content="Sash – Bootstrap 5  Admin & Dashboard Template"
    />
    <meta name="author" content="Spruko Technologies Private Limited" />
    <meta
      name="keywords"
      content="admin,admin dashboard,admin panel,admin template,bootstrap,clean,dashboard,flat,jquery,modern,responsive,premium admin templates,responsive admin,ui,ui kit."
    />

    <!-- FAVICON -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="../assets/images/brand/favicon.ico"
    />

    <!-- TITLE -->
    <title>Sash – Bootstrap 5 Admin & Dashboard Template</title>

    <!-- BOOTSTRAP CSS -->
    <link
      id="style"
      href="../assets/plugins/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- STYLE CSS -->
    <link href="../assets/css/style.css" rel="stylesheet" />

    <!-- Plugins CSS -->
    <link href="../assets/css/plugins.css" rel="stylesheet" />

    <!--- FONT-ICONS CSS -->
    <link href="../assets/css/icons.css" rel="stylesheet" />

    <!-- INTERNAL Switcher css -->
    <link href="../assets/switcher/css/switcher.css" rel="stylesheet" />
    <link href="../assets/switcher/demo.css" rel="stylesheet" />
  </head>

  <body class="app sidebar-mini ltr light-mode">
    <!-- GLOBAL-LOADER -->
    <div id="global-loader">
      <img src="../assets/images/loader.svg" class="loader-img" alt="Loader" />
    </div>
    <!-- /GLOBAL-LOADER -->

    <!-- PAGE -->
    <div class="page">
      <div class="page-main">
        <!-- app-Header -->
        <div class="app-header header sticky">
          <div class="container-fluid main-container">
            <div class="d-flex">
              <a
                aria-label="Hide Sidebar"
                class="app-sidebar__toggle"
                data-bs-toggle="sidebar"
                href="javascript:void(0)"
              ></a>
              <!-- sidebar-toggle-->
              <a class="logo-horizontal" href="index.html">
                <img
                  src="../assets/images/brand/logo-white.png"
                  class="header-brand-img desktop-logo"
                  alt="logo"
                />
                <img
                  src="../assets/images/brand/logo-dark.png"
                  class="header-brand-img light-logo1"
                  alt="logo"
                />
              </a>
              <!-- LOGO -->
              <div class="main-header-center ms-3 d-none d-lg-block">
                <input
                  type="text"
                  class="form-control"
                  id="typehead"
                  placeholder="Search for results..."
                />
                <button class="btn px-0 pt-2">
                  <i class="fe fe-search" aria-hidden="true"></i>
                </button>
              </div>
              <div class="d-flex order-lg-2 ms-auto header-right-icons">
                <!-- SEARCH -->
                <button
                  class="navbar-toggler navresponsive-toggler d-lg-none ms-auto"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#navbarSupportedContent-4"
                  aria-controls="navbarSupportedContent-4"
                  aria-expanded="false"
                  aria-label="Toggle navigation"
                >
                  <span class="navbar-toggler-icon fe fe-more-vertical"></span>
                </button>
                <div class="navbar navbar-collapse responsive-navbar p-0">
                  <div
                    class="collapse navbar-collapse"
                    id="navbarSupportedContent-4"
                  >
                    <div class="d-flex order-lg-2">
                      <div class="dropdown d-lg-none d-flex">
                        <a
                          href="javascript:void(0)"
                          class="nav-link icon"
                          data-bs-toggle="dropdown"
                        >
                          <i class="fe fe-search"></i>
                        </a>
                        <div
                          class="dropdown-menu header-search dropdown-menu-start"
                        >
                          <div class="input-group w-100 p-2">
                            <input
                              type="text"
                              class="form-control"
                              placeholder="Search...."
                            />
                            <div class="input-group-text btn btn-primary">
                              <i class="fa fa-search" aria-hidden="true"></i>
                            </div>
                          </div>
                        </div>
                      </div>
                     
                      <!-- COUNTRY -->
                      <div class="d-flex">
                        <a
                          class="nav-link icon theme-layout nav-link-bg layout-setting"
                        >
                          <span class="dark-layout"
                            ><i class="fe fe-moon"></i
                          ></span>
                          <span class="light-layout"
                            ><i class="fe fe-sun"></i
                          ></span>
                        </a>
                      </div>
                      <!-- Theme-Layout -->
                       
                      <!-- CART -->
                      <div class="dropdown d-flex">
                        <a class="nav-link icon full-screen-link nav-link-bg">
                          <i class="fe fe-minimize fullscreen-button"></i>
                        </a>
                      </div>
                      <!-- FULL-SCREEN -->
                      <div class="dropdown d-flex notifications">
                        <a class="nav-link icon" data-bs-toggle="dropdown"
                          ><i class="fe fe-bell"></i><span class="pulse"></span>
                        </a>
                        <div
                          class="dropdown-menu dropdown-menu-end dropdown-menu-arrow"
                        >
                          <div class="drop-heading border-bottom">
                            <div class="d-flex">
                              <h6 class="mt-1 mb-0 fs-16 fw-semibold text-dark">
                                Notifications
                              </h6>
                            </div>
                          </div>
                          <div class="notifications-menu">
                            <a
                              class="dropdown-item d-flex"
                              href="notify-list.html"
                            >
                              <div
                                class="me-3 notifyimg bg-primary brround box-shadow-primary"
                              >
                                <i class="fe fe-mail"></i>
                              </div>
                              <div class="mt-1 wd-80p">
                                <h5 class="notification-label mb-1">
                                  New Application received
                                </h5>
                                <span class="notification-subtext"
                                  >3 days ago</span
                                >
                              </div>
                            </a>
                            <a
                              class="dropdown-item d-flex"
                              href="notify-list.html"
                            >
                              <div
                                class="me-3 notifyimg bg-secondary brround box-shadow-secondary"
                              >
                                <i class="fe fe-check-circle"></i>
                              </div>
                              <div class="mt-1 wd-80p">
                                <h5 class="notification-label mb-1">
                                  Project has been approved
                                </h5>
                                <span class="notification-subtext"
                                  >2 hours ago</span
                                >
                              </div>
                            </a>
                            <a
                              class="dropdown-item d-flex"
                              href="notify-list.html"
                            >
                              <div
                                class="me-3 notifyimg bg-success brround box-shadow-success"
                              >
                                <i class="fe fe-shopping-cart"></i>
                              </div>
                              <div class="mt-1 wd-80p">
                                <h5 class="notification-label mb-1">
                                  Your Product Delivered
                                </h5>
                                <span class="notification-subtext"
                                  >30 min ago</span
                                >
                              </div>
                            </a>
                            <a
                              class="dropdown-item d-flex"
                              href="notify-list.html"
                            >
                              <div
                                class="me-3 notifyimg bg-pink brround box-shadow-pink"
                              >
                                <i class="fe fe-user-plus"></i>
                              </div>
                              <div class="mt-1 wd-80p">
                                <h5 class="notification-label mb-1">
                                  Friend Requests
                                </h5>
                                <span class="notification-subtext"
                                  >1 day ago</span
                                >
                              </div>
                            </a>
                          </div>
                          <div class="dropdown-divider m-0"></div>
                          <a
                            href="notify-list.html"
                            class="dropdown-item text-center p-3 text-muted"
                            >View all Notification</a
                          >
                        </div>
                      </div>
                      <!-- NOTIFICATIONS -->
                      <div class="dropdown d-flex message">
                        <a
                          class="nav-link icon text-center"
                          data-bs-toggle="dropdown"
                        >
                          <i class="fe fe-message-square"></i
                          ><span class="pulse-danger"></span>
                        </a>
                      
                      </div>
                      <!-- MESSAGE-BOX -->
                      <div class="dropdown d-flex header-settings">
                        <a
                          href="javascript:void(0);"
                          class="nav-link icon"
                          data-bs-toggle="sidebar-right"
                          data-target=".sidebar-right"
                        >
                          <i class="fe fe-align-right"></i>
                        </a>
                      </div>
                      <!-- SIDE-MENU -->
                      <div class="dropdown d-flex profile-1">
                        <a
                          href="javascript:void(0)"
                          data-bs-toggle="dropdown"
                          class="nav-link leading-none d-flex"
                        >
                          <img
                            src="../assets/images/users/21.jpg"
                            alt="profile-user"
                            class="avatar profile-user brround cover-image"
                          />
                        </a>
                        <div
                          class="dropdown-menu dropdown-menu-end dropdown-menu-arrow"
                        >
                          <div class="drop-heading">
                            <div class="text-center">
                              <h5 class="text-dark mb-0 fs-14 fw-semibold">
                                Percy Kewshun
                              </h5>
                              <small class="text-muted">Senior Admin</small>
                            </div>
                          </div>
                          <div class="dropdown-divider m-0"></div>
                          <a class="dropdown-item" href="profile.html">
                            <i class="dropdown-icon fe fe-user"></i> Profile
                          </a>
                          <a class="dropdown-item" href="email-inbox.html">
                            <i class="dropdown-icon fe fe-mail"></i> Inbox
                            <span class="badge bg-danger rounded-pill float-end"
                              >5</span
                            >
                          </a>
                          <a class="dropdown-item" href="lockscreen.html">
                            <i class="dropdown-icon fe fe-lock"></i> Lockscreen
                          </a>
                          <a class="dropdown-item" href="login.html">
                            <i class="dropdown-icon fe fe-alert-circle"></i>
                            Sign out
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- /app-Header -->

        <!--APP-SIDEBAR-->
        <div class="sticky">
          <div class="app-sidebar__overlay" data-bs-toggle="sidebar"></div>
          <div class="app-sidebar">
            <div class="side-header">
              <a class="header-brand1" href="index.html">
                <img
                  src="../assets/images/brand/logo-white.png"
                  class="header-brand-img desktop-logo"
                  alt="logo"
                />
                <img
                  src="../assets/images/brand/icon-white.png"
                  class="header-brand-img toggle-logo"
                  alt="logo"
                />
                <img
                  src="../assets/images/brand/icon-dark.png"
                  class="header-brand-img light-logo"
                  alt="logo"
                />
                <img
                  src="../assets/images/brand/logo-dark.png"
                  class="header-brand-img light-logo1"
                  alt="logo"
                />
              </a>
              <!-- LOGO -->
            </div>
            <div class="main-sidemenu">
              <div class="slide-left disabled" id="slide-left">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="#7b8191"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z"
                  />
                </svg>
              </div>
              <ul class="side-menu">
                <li class="sub-category">
                  <h3>Main</h3>
                </li>
                <li class="slide">
                  <a
                    class="side-menu__item has-link"
                    data-bs-toggle="slide"
                    href="index.html"
                    ><i class="side-menu__icon fe fe-home"></i
                    ><span class="side-menu__label">Tableau de Bord</span></a
                  >
                </li>
                <li class="sub-category">
                  <h3>UI Kit</h3>
                </li>
               
               
                <li>
                  <a
                    class="side-menu__item has-link"
                    href="landing-page.html"
                    target="_blank"
                    ><i class="side-menu__icon fe fe-zap"></i
                    ><span class="side-menu__label">Landing Page</span
                    ><span
                      class="badge bg-green br-5 side-badge blink-text pb-1"
                      >New</span
                    ></a
                  >
                </li>
                <li class="sub-category">
                  <h3>Pre-build Pages</h3>
                </li>
           
                <li class="sub-category">
                  <h3>Misc Pages</h3>
                </li>
            
               
                <li class="sub-category">
                  <h3>General</h3>
                </li>
            
                
                
              </ul>
              <div class="slide-right" id="slide-right">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="#7b8191"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M10.707 17.707 16.414 12l-5.707-5.707-1.414 1.414L13.586 12l-4.293 4.293z"
                  />
                </svg>
              </div>
            </div>
          </div>
        </div>
        <!--/APP-SIDEBAR-->

        <!--app-content open-->
        <div class="main-content app-content mt-0">
          <div class="side-app">
            <!-- CONTAINER -->
            <div class="main-container container-fluid">
              <!-- PAGE-HEADER -->
              <div class="page-header">
                <h1 class="page-title">Liste des annonces</h1>
                <div>
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="javascript:void(0)">Annonces</a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                      Liste
                    </li>
                  </ol>
                </div>
              </div>
              <!-- PAGE-HEADER END -->

              <!-- End Row -->
              <!-- Row -->
              <div class="row row-sm">
                <div class="col-lg-12">
                  <div class="card">
                    <div class="card-header d-flex justify-content-between">
                      <h3 class="card-title" id="resultats">
                        20 annonces trouvés
                      </h3>
                      <a href="creer-annonce.html" class="btn btn-primary float-right" id="btn-add"
>Ajouter une annonce</a>
                    </div>

                    <div class="card-body">
                      <div class="table-responsive">
                        <table
                          class="table table-bordered border text-nowrap mb-0"
                          id="removecolumns-edit"
                        >
                          <thead>
                            <tr>
                              <th>N°</th>
                              <th>Titre</th>
                              <th>Type</th>
                              <th>Status</th>
                              <th>Date de Publication</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>...</td>
                              <td>...</td>
                              <td>...</td>
                              <td>...</td>
                              <td>...</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- End Row -->
            </div>
            <!-- CONTAINER CLOSED -->
          </div>
        </div>
        <!--app-content closed-->
      </div>

      <!-- Sidebar-right -->
      
      <!--/Sidebar-right-->

      <!-- Country-selector modal-->
      <div class="modal fade" id="country-selector">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content country-select-modal">
            <div class="modal-header">
              <h6 class="modal-title">Choose Country</h6>
              <button
                aria-label="Close"
                class="btn-close"
                data-bs-dismiss="modal"
                type="button"
              >
                <span aria-hidden="true">×</span>
              </button>
            </div>
            <div class="modal-body">
              <ul class="row p-3">
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block active"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/us_flag.jpg"
                        class="me-3 language" /></span
                    >USA
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/italy_flag.jpg"
                        class="me-3 language" /></span
                    >Italy
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/spain_flag.jpg"
                        class="me-3 language" /></span
                    >Spain
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/india_flag.jpg"
                        class="me-3 language" /></span
                    >India
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/french_flag.jpg"
                        class="me-3 language" /></span
                    >French
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/russia_flag.jpg"
                        class="me-3 language" /></span
                    >Russia
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/germany_flag.jpg"
                        class="me-3 language" /></span
                    >Germany
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/argentina.jpg"
                        class="me-3 language" /></span
                    >Argentina
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/malaysia.jpg"
                        class="me-3 language" /></span
                    >Malaysia
                  </a>
                </li>
                <li class="col-lg-6 mb-2">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-country btn-lg btn-block"
                  >
                    <span class="country-selector"
                      ><img
                        alt=""
                        src="../assets/images/flags-img/turkey.jpg"
                        class="me-3 language" /></span
                    >Turkey
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <!-- Country-selector modal-->

      <!-- FOOTER -->
      <footer class="footer">
        <div class="container">
          <div class="row align-items-center flex-row-reverse">
            <div class="col-md-12 col-sm-12 text-center">
              Copyright © <span id="year"></span>
              <a href="javascript:void(0)">Sash</a>. Designed with
              <span class="fa fa-heart text-danger"></span> by
              <a href="javascript:void(0)"> Spruko </a> All rights reserved.
            </div>
          </div>
        </div>
      </footer>
      <!-- FOOTER CLOSED -->
    </div>

    <!-- BACK-TO-TOP -->
    <a href="#top" id="back-to-top"><i class="fa fa-angle-up"></i></a>

    <!-- JQUERY JS -->
    <script src="../assets/js/jquery.min.js"></script>

    <!-- BOOTSTRAP JS -->
    <script src="../assets/plugins/bootstrap/js/popper.min.js"></script>
    <script src="../assets/plugins/bootstrap/js/bootstrap.min.js"></script>

    <!-- INPUT MASK JS-->
    <script src="../assets/plugins/input-mask/jquery.mask.min.js"></script>

    <!-- TypeHead js -->
    <script src="../assets/plugins/bootstrap5-typehead/autocomplete.js"></script>
    <script src="../assets/js/typehead.js"></script>

    <!-- INTERNAL SELECT2 JS -->
    <script src="../assets/plugins/select2/select2.full.min.js"></script>

    <!-- DATA TABLE JS-->
    <script src="../assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
    <script src="../assets/plugins/datatable/js/dataTables.bootstrap5.js"></script>
    <script src="../assets/plugins/datatable/js/dataTables.buttons.min.js"></script>
    <script src="../assets/plugins/datatable/js/buttons.bootstrap5.min.js"></script>
    <script src="../assets/plugins/datatable/js/jszip.min.js"></script>
    <script src="../assets/plugins/datatable/pdfmake/pdfmake.min.js"></script>
    <script src="../assets/plugins/datatable/pdfmake/vfs_fonts.js"></script>
    <script src="../assets/plugins/datatable/js/buttons.html5.min.js"></script>
    <script src="../assets/plugins/datatable/js/buttons.print.min.js"></script>
    <script src="../assets/plugins/datatable/js/buttons.colVis.min.js"></script>
    <script src="../assets/plugins/datatable/dataTables.responsive.min.js"></script>
    <script src="../assets/plugins/datatable/responsive.bootstrap5.min.js"></script>
    <script src="../assets/js/table-data.js"></script>

    <!-- Perfect SCROLLBAR JS-->
    <script src="../assets/plugins/p-scroll/perfect-scrollbar.js"></script>
    <script src="../assets/plugins/p-scroll/pscroll.js"></script>
    <script src="../assets/plugins/p-scroll/pscroll-1.js"></script>

    <!-- SIDE-MENU JS -->
    <script src="../assets/plugins/sidemenu/sidemenu.js"></script>

    <!-- SIDEBAR JS -->
    <script src="../assets/plugins/sidebar/sidebar.js"></script>

    <!-- Color Theme js -->
    <script src="../assets/js/themeColors.js"></script>

    <!-- Sticky js -->
    <script src="../assets/js/sticky.js"></script>

    <!-- CUSTOM JS -->
    <script src="../assets/js/custom.js"></script>

    <!-- Custom-switcher -->
    <script src="../assets/js/custom-swicher.js"></script>

    <!-- Switcher js -->
    <script src="../assets/switcher/js/switcher.js"></script>

    <script>
      const token = localStorage.getItem("token"); // ou sessionStorage, selon ton app
      $(document).ready(function () {
        $.ajax({
          url: "http://localhost:5001/api/annonces/", // 👉 Remplace par ton endpoint réel
          method: "GET",
          headers: {
            Authorization: "Bearer " + localStorage.getItem("token"),
          },
          success: function (response) {
            if (response.statut === "succes") {
              const results = response.resultats;
              $("#resultats").html(`${results} annonces trouvées`);
              const annonces = response.data;

              const tbody = $("#removecolumns-edit tbody");
              tbody.empty(); // Vider l'ancien contenu

              annonces.forEach((annonce, index) => {
                const row = `
              <tr>
                <td>${index + 1}</td>
                <td>${annonce.titre || ""}</td>
                <td>${annonce.type || ""}</td>
                <td><span class="badge bg-${
                  annonce.status === "publié" ? "success" : "warning"
                }">${annonce.status}</span></td>
                <td>${new Date(
                  annonce.datePublication
                ).toLocaleDateString()}</td>
                <td>
                 <button class="btn btn-sm btn-primary btn-view" data-id="${
                   annonce._id
                 }">Voir</button>
                  <button class="btn btn-sm btn-warning btn-edit" data-id="${
                    annonce._id
                  }">Modifier</button>
                  <button class="btn btn-sm btn-danger btn-delete" data-id="${
                    annonce._id
                  }">Supprimer</button>
                </td>
              </tr>
            `;
                tbody.append(row);
              });
            } else {
              console.log(response.message);
            }
          },
          error: function (erreur) {
              console.log(erreur);

          },
        });
      });

      $(document).on("click", ".btn-view", function () {
        const id = $(this).data("id");

        $.ajax({
          url: `http://localhost:5001/api/annonces/${id}`,
          type: "GET",
          headers: {
            Authorization: `Bearer ${token}`,
          },
          success: function (res) {
            const annonce = res.data;
            $("#viewTitre").text(annonce.titre);
            $("#viewType").text(annonce.type);
            $("#viewStatus").text(annonce.status);
            $("#viewDate").text(
              new Date(annonce.datePublication).toLocaleDateString()
            );
            $("#viewDescription").text(annonce.contenu || "");
            $("#viewModal").modal("show");
          },
          error: function () {
            alert("Erreur lors de la consultation.");
          },
        });
      });

      

      $(document).on("click", ".btn-edit", function () {
  const id = $(this).data("id");

  $.ajax({
    url: `http://localhost:5001/api/annonces/${id}`,
    type: "PATCH",
    headers: {
      Authorization: `Bearer ${token}`,
    },
    success: function (res) {
      const annonce = res.data;
      $("#editId").val(annonce._id);
      $("#editTitre").val(annonce.titre);
      $("#editType").val(annonce.type);
      $("#editStatus").val(annonce.status);
      $("#editDescription").val(annonce.description || "");
      $("#editModal").modal("show");
    },
  });
});

$("#editForm").submit(function (e) {
  e.preventDefault();

  const id = $("#editId").val();
  const data = {
    titre: $("#editTitre").val(),
    type: $("#editType").val(),
    status: $("#editStatus").val(),
    description: $("#editDescription").val(),
  };

  $.ajax({
    url: `http://localhost:5001/api/annonces/${id}`,
    type: "PATCH",
    data: JSON.stringify(data),
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${token}`,
    },
    success: function () {
      $("#editModal").modal("hide");
      alert("Annonce modifiée avec succès !");
      location.reload();
    },
    error: function () {
      alert("Erreur lors de la modification.");
    },
  });
});




$(document).on("click", ".btn-delete", function () {
  const id = $(this).data("id");

  if (!confirm("Voulez-vous vraiment supprimer cette annonce ?")) return;

  $.ajax({
    url: `http://localhost:5001/api/annonces/${id}`,
    type: "DELETE",
    headers: {
      Authorization: `Bearer ${token}`,
    },
    success: function () {
      alert("Annonce supprimée !");
      location.reload();
    },
    error: function () {
      alert("Erreur lors de la suppression.");
    },
  });
});


    </script>

    <!-- Modal Consultation -->
    <div
      class="modal fade"
      id="viewModal"
      tabindex="-1"
      aria-labelledby="viewModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="viewModalLabel">
              Détails de l'annonce
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <p><strong>Titre :</strong> <span id="viewTitre"></span></p>
            <p><strong>Type :</strong> <span id="viewType"></span></p>
            <p><strong>Status :</strong> <span id="viewStatus"></span></p>
            <p>
              <strong>Date de publication :</strong> <span id="viewDate"></span>
            </p>
            <p>
              <strong>Description :</strong> <span id="viewDescription"></span>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Modification -->
    <div
      class="modal fade"
      id="editModal"
      tabindex="-1"
      aria-labelledby="editModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <form id="editForm">
            <div class="modal-header">
              <h5 class="modal-title" id="editModalLabel">
                Modifier l'annonce
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
            <div class="modal-body">
              <input type="hidden" id="editId" />
              <div class="mb-3">
                <label for="editTitre" class="form-label">Titre</label>
                <input type="text" class="form-control" id="editTitre" />
              </div>
              <div class="mb-3">
                <label for="editType" class="form-label">Type</label>
                <input type="text" class="form-control" id="editType" />
              </div>
              <div class="mb-3">
                <label for="editStatus" class="form-label">Status</label>
                <select id="editStatus" class="form-select">
                  <option value="publié">Publié</option>
                  <option value="brouillon">Brouillon</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="editDescription" class="form-label"
                  >Description</label
                >
                <textarea class="form-control" id="editDescription"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary">Enregistrer</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
